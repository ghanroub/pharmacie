<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تصحيح امتحان الصيدلة QCM</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f9ff;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 100, 0.1);
            padding: 30px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #4a6fa5;
            padding-bottom: 20px;
        }
        
        h1 {
            color: #2c3e5c;
            margin-bottom: 10px;
        }
        
        .description {
            color: #555;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 20px;
        }
        
        .highlight {
            background-color: #e8f4ff;
            padding: 15px;
            border-radius: 10px;
            border-right: 4px solid #4a6fa5;
            margin: 20px 0;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
        
        .questions-section, .results-section {
            background-color: #f9fbff;
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #d1e0ff;
        }
        
        .question {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            border: 1px solid #e1e8ff;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }
        
        .question h3 {
            color: #2c3e5c;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .question-number {
            background-color: #4a6fa5;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
        }
        
        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        @media (max-width: 480px) {
            .options {
                grid-template-columns: 1fr;
            }
        }
        
        .option {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background-color: #f0f5ff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #d1e0ff;
        }
        
        .option:hover {
            background-color: #e4edff;
        }
        
        .option.selected {
            background-color: #d4e4ff;
            border-color: #4a6fa5;
        }
        
        .option input {
            margin-left: 10px;
            transform: scale(1.2);
        }
        
        .option label {
            cursor: pointer;
            flex-grow: 1;
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        #correctBtn {
            background-color: #4a6fa5;
            color: white;
        }
        
        #correctBtn:hover {
            background-color: #3a5a8a;
        }
        
        #resetBtn {
            background-color: #f0f0f0;
            color: #555;
        }
        
        #resetBtn:hover {
            background-color: #e0e0e0;
        }
        
        .score-box {
            background: linear-gradient(135deg, #4a6fa5, #2c3e5c);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .score {
            font-size: 3rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .details h3 {
            color: #2c3e5c;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e1e8ff;
        }
        
        .question-result {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: 1px solid #e1e8ff;
        }
        
        .question-result.correct {
            background-color: #e8f7ef;
            border-color: #b8e6c9;
        }
        
        .question-result.partial {
            background-color: #fff8e8;
            border-color: #ffdd99;
        }
        
        .question-result.wrong {
            background-color: #ffe8e8;
            border-color: #ffb8b8;
        }
        
        .question-result-header {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .result-details {
            font-size: 0.95rem;
            color: #555;
        }
        
        .correct-answers {
            color: #2d8a4a;
            font-weight: bold;
        }
        
        .student-answers {
            color: #4a6fa5;
            font-weight: bold;
        }
        
        .note {
            font-style: italic;
            margin-top: 5px;
            color: #777;
        }
        
        .rules {
            background-color: #fff8e8;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-right: 4px solid #ffaa33;
        }
        
        .rules h4 {
            color: #b37400;
            margin-bottom: 10px;
        }
        
        .rules ul {
            padding-right: 20px;
        }
        
        .rules li {
            margin-bottom: 8px;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-left: 8px;
        }
        
        .full-points {
            background-color: #e8f7ef;
        }
        
        .partial-points {
            background-color: #fff8e8;
        }
        
        .zero-points {
            background-color: #ffe8e8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>نظام تصحيح امتحان الصيدلة (QCM)</h1>
            <p class="description">هذا النظام يطبق قاعدة التصحيح التي ذكرتها: يجب اختيار جميع الإجابات الصحيحة فقط للحصول على النقطة الكاملة. أي إجابة خاطئة واحدة تعطي صفرًا للنقطة الكاملة لهذا السؤال.</p>
            
            <div class="highlight">
                <strong>قواعد التصحيح:</strong>
                <ul>
                    <li>✓ اختيار <strong>جميع</strong> الإجابات الصحيحة فقط → النقطة كاملة</li>
                    <li>✓ اختيار <strong>بعض</strong> الإجابات الصحيحة فقط → نقاط جزئية</li>
                    <li>✗ اختيار أي إجابة خاطئة (ولو واحدة) → صفر نقطة للسؤال</li>
                </ul>
            </div>
        </header>
        
        <div class="grid">
            <section class="questions-section">
                <h2>أسئلة اختبار الصيدلة</h2>
                
                <!-- السؤال 1 -->
                <div class="question" id="q1">
                    <h3><span class="question-number">1</span> أي من الأدوية التالية تنتمي إلى فئة الستاتين (خافضات الكوليسترول)؟</h3>
                    <div class="options">
                        <div class="option" onclick="toggleOption('q1', 'A')">
                            <input type="checkbox" id="q1-A">
                            <label for="q1-A">أ. أتورفاستاتين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q1', 'B')">
                            <input type="checkbox" id="q1-B">
                            <label for="q1-B">ب. كلوبيدوجريل</label>
                        </div>
                        <div class="option" onclick="toggleOption('q1', 'C')">
                            <input type="checkbox" id="q1-C">
                            <label for="q1-C">ج. سيمفاستاتين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q1', 'D')">
                            <input type="checkbox" id="q1-D">
                            <label for="q1-D">د. ميتفورمين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q1', 'E')">
                            <input type="checkbox" id="q1-E">
                            <label for="q1-E">هـ. روسوفاستاتين</label>
                        </div>
                    </div>
                </div>
                
                <!-- السؤال 2 -->
                <div class="question" id="q2">
                    <h3><span class="question-number">2</span> أي من الأدوية التالية هي مضادات للهيستامين من الجيل الأول (تسبب النعاس)؟</h3>
                    <div class="options">
                        <div class="option" onclick="toggleOption('q2', 'A')">
                            <input type="checkbox" id="q2-A">
                            <label for="q2-A">أ. ديفينهيدرامين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q2', 'B')">
                            <input type="checkbox" id="q2-B">
                            <label for="q2-B">ب. لوراتادين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q2', 'C')">
                            <input type="checkbox" id="q2-C">
                            <label for="q2-C">ج. سيتريزين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q2', 'D')">
                            <input type="checkbox" id="q2-D">
                            <label for="q2-D">د. فيكسوفينادين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q2', 'E')">
                            <input type="checkbox" id="q2-E">
                            <label for="q2-E">هـ. كلورفينيرامين</label>
                        </div>
                    </div>
                </div>
                
                <!-- السؤال 3 -->
                <div class="question" id="q3">
                    <h3><span class="question-number">3</span> أي من الآتي يعتبر من حاصرات بيتا (Beta Blockers)؟</h3>
                    <div class="options">
                        <div class="option" onclick="toggleOption('q3', 'A')">
                            <input type="checkbox" id="q3-A">
                            <label for="q3-A">أ. أتينولول</label>
                        </div>
                        <div class="option" onclick="toggleOption('q3', 'B')">
                            <input type="checkbox" id="q3-B">
                            <label for="q3-B">ب. نيفيديبين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q3', 'C')">
                            <input type="checkbox" id="q3-C">
                            <label for="q3-C">ج. بروبرانولول</label>
                        </div>
                        <div class="option" onclick="toggleOption('q3', 'D')">
                            <input type="checkbox" id="q3-D">
                            <label for="q3-D">د. فيراباميل</label>
                        </div>
                        <div class="option" onclick="toggleOption('q3', 'E')">
                            <input type="checkbox" id="q3-E">
                            <label for="q3-E">هـ. ميتوبرولول</label>
                        </div>
                    </div>
                </div>
                
                <!-- السؤال 4 -->
                <div class="question" id="q4">
                    <h3><span class="question-number">4</span> أي من الأدوية التالية تستخدم بشكل أساسي في علاج الربو؟</h3>
                    <div class="options">
                        <div class="option" onclick="toggleOption('q4', 'A')">
                            <input type="checkbox" id="q4-A">
                            <label for="q4-A">أ. سالميتيرول</label>
                        </div>
                        <div class="option" onclick="toggleOption('q4', 'B')">
                            <input type="checkbox" id="q4-B">
                            <label for="q4-B">ب. لوراتادين</label>
                        </div>
                        <div class="option" onclick="toggleOption('q4', 'C')">
                            <input type="checkbox" id="q4-C">
                            <label for="q4-C">ج. مونتيلوكاست</label>
                        </div>
                        <div class="option" onclick="toggleOption('q4', 'D')">
                            <input type="checkbox" id="q4-D">
                            <label for="q4-D">د. بوديزونيد</label>
                        </div>
                        <div class="option" onclick="toggleOption('q4', 'E')">
                            <input type="checkbox" id="q4-E">
                            <label for="q4-E">هـ. إبراتروبيوم</label>
                        </div>
                    </div>
                </div>
                
                <!-- السؤال 5 -->
                <div class="question" id="q5">
                    <h3><span class="question-number">5</span> أي من الأدوية التالية هي من مثبطات الإنزيم المحول للأنجيوتنسين (ACE Inhibitors)؟</h3>
                    <div class="options">
                        <div class="option" onclick="toggleOption('q5', 'A')">
                            <input type="checkbox" id="q5-A">
                            <label for="q5-A">أ. ليسينوبريل</label>
                        </div>
                        <div class="option" onclick="toggleOption('q5', 'B')">
                            <input type="checkbox" id="q5-B">
                            <label for="q5-B">ب. لوزارتان</label>
                        </div>
                        <div class="option" onclick="toggleOption('q5', 'C')">
                            <input type="checkbox" id="q5-C">
                            <label for="q5-C">ج. كابتوبريل</label>
                        </div>
                        <div class="option" onclick="toggleOption('q5', 'D')">
                            <input type="checkbox" id="q5-D">
                            <label for="q5-D">د. فالسارتان</label>
                        </div>
                        <div class="option" onclick="toggleOption('q5', 'E')">
                            <input type="checkbox" id="q5-E">
                            <label for="q5-E">هـ. راميبريل</label>
                        </div>
                    </div>
                </div>
                
                <div class="buttons">
                    <button id="correctBtn" onclick="correctExam()">تصحيح الإجابات</button>
                    <button id="resetBtn" onclick="resetExam()">بدء اختبار جديد</button>
                </div>
                
                <div class="rules">
                    <h4>تذكر: إستراتيجية الاختبار</h4>
                    <ul>
                        <li>كن حذرًا ولا تختر أي إجابة إلا إذا كنت متأكدًا منها 100%</li>
                        <li>اختيار إجابة خاطئة واحدة يلغي جميع النقاط لهذا السؤال</li>
                        <li>من الأفضل ترك إجابة مشكوك فيها بدلاً من خسارة النقاط</li>
                    </ul>
                </div>
            </section>
            
            <section class="results-section">
                <div class="score-box" id="scoreBox">
                    <h2>النتيجة</h2>
                    <p>سيظهر هنا تقييم إجاباتك بعد التصحيح</p>
                    <div class="score">--/5</div>
                    <p>نسبة النجاح: --%</p>
                </div>
                
                <div class="details" id="resultsDetails">
                    <h3>تفاصيل التصحيح</h3>
                    <p>بعد الضغط على زر "تصحيح الإجابات"، ستظهر هنا تفاصيل كل سؤال ونتيجته.</p>
                </div>
                
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color full-points"></div>
                        <span>النقطة كاملة</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color partial-points"></div>
                        <span>نقاط جزئية</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color zero-points"></div>
                        <span>صفر نقطة</span>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // قاعدة البيانات: الإجابات الصحيحة لكل سؤال
        const correctAnswers = {
            "q1": ["A", "C", "E"],  // أتورفاستاتين، سيمفاستاتين، روسوفاستاتين
            "q2": ["A", "E"],       // ديفينهيدرامين، كلورفينيرامين
            "q3": ["A", "C", "E"],  // أتينولول، بروبرانولول، ميتوبرولول
            "q4": ["A", "C", "D", "E"], // سالميتيرول، مونتيلوكاست، بوديزونيد، إبراتروبيوم
            "q5": ["A", "C", "E"]   // ليسينوبريل، كابتوبريل، راميبريل
        };
        
        // إجابات الطالب (يتم ملؤها من الخيارات المحددة)
        let studentAnswers = {};
        
        // تبديل اختيار الخيار
        function toggleOption(questionId, option) {
            const checkbox = document.getElementById(`${questionId}-${option}`);
            checkbox.checked = !checkbox.checked;
            
            // تحديث العنصر المرئي
            const optionElement = checkbox.parentElement;
            optionElement.classList.toggle("selected");
        }
        
        // جمع إجابات الطالب من الواجهة
        function collectStudentAnswers() {
            studentAnswers = {};
            
            // لكل سؤال
            for (const questionId in correctAnswers) {
                const selectedOptions = [];
                
                // لكل خيار محتمل (A-E)
                for (const option of ["A", "B", "C", "D", "E"]) {
                    const checkbox = document.getElementById(`${questionId}-${option}`);
                    if (checkbox && checkbox.checked) {
                        selectedOptions.push(option);
                    }
                }
                
                studentAnswers[questionId] = selectedOptions;
            }
            
            return studentAnswers;
        }
        
        // تصحيح الامتحان حسب القاعدة المحددة
        function correctExam() {
            // جمع إجابات الطالب
            collectStudentAnswers();
            
            let totalScore = 0;
            const maxScore = 5; // 5 أسئلة، كل سؤال قيمته 1
            const results = {};
            
            // تصحيح كل سؤال
            for (const questionId in correctAnswers) {
                const correctList = correctAnswers[questionId];
                const studentList = studentAnswers[questionId] || [];
                
                // إذا لم يختر الطالب أي إجابة
                if (studentList.length === 0) {
                    results[questionId] = {
                        score: 0,
                        correctChoices: correctList,
                        studentChoices: studentList,
                        note: 'لم يتم الاختيار'
                    };
                    continue;
                }
                
                // تحقق من وجود أي إجابة خاطئة
                let hasWrongAnswer = false;
                for (const choice of studentList) {
                    if (!correctList.includes(choice)) {
                        hasWrongAnswer = true;
                        break;
                    }
                }
                
                if (hasWrongAnswer) {
                    // وجود إجابة خاطئة واحدة → صفر
                    results[questionId] = {
                        score: 0,
                        correctChoices: correctList,
                        studentChoices: studentList,
                        note: 'احتوى على إجابة خاطئة'
                    };
                    continue;
                }
                
                // احسب النقاط الجزئية (بدون أخطاء)
                const correctSelected = studentList.length;
                const totalCorrect = correctList.length;
                
                if (correctSelected === totalCorrect) {
                    // كل الإجابات الصحيحة → النقطة كاملة
                    results[questionId] = {
                        score: 1,
                        correctChoices: correctList,
                        studentChoices: studentList,
                        note: 'إجابة كاملة'
                    };
                    totalScore += 1;
                } else if (correctSelected === 0) {
                    // لم يختر أي إجابة صحيحة (مع أن الخيارات كلها صحيحة) → 0
                    results[questionId] = {
                        score: 0,
                        correctChoices: correctList,
                        studentChoices: studentList,
                        note: 'لم يختر أي إجابة صحيحة'
                    };
                } else {
                    // نقاط جزئية: (عدد الإجابات الصحيحة المختارة / عدد الإجابات الصحيحة الكلي)
                    const score = correctSelected / totalCorrect;
                    results[questionId] = {
                        score: parseFloat(score.toFixed(2)),
                        correctChoices: correctList,
                        studentChoices: studentList,
                        note: `جزئي (${correctSelected}/${totalCorrect})`
                    };
                    totalScore += score;
                }
            }
            
            // عرض النتائج
            displayResults(totalScore, maxScore, results);
        }
        
        // عرض النتائج في الواجهة
        function displayResults(totalScore, maxScore, results) {
            // حساب النسبة المئوية
            const percentage = ((totalScore / maxScore) * 100).toFixed(2);
            
            // تحديث صندوق النتيجة
            const scoreBox = document.getElementById('scoreBox');
            scoreBox.innerHTML = `
                <h2>النتيجة</h2>
                <div class="score">${totalScore.toFixed(2)}/${maxScore}</div>
                <p>نسبة النجاح: ${percentage}%</p>
                <p>${percentage >= 60 ? '✅ ناجح' : '❌ غير ناجح'}</p>
            `;
            
            // تحديث تفاصيل التصحيح
            const resultsDetails = document.getElementById('resultsDetails');
            let detailsHTML = '<h3>تفاصيل التصحيح</h3>';
            
            for (const questionId in results) {
                const result = results[questionId];
                const questionNum = questionId.charAt(questionId.length-1);
                let resultClass = '';
                
                if (result.score === 1) {
                    resultClass = 'correct';
                } else if (result.score > 0) {
                    resultClass = 'partial';
                } else {
                    resultClass = 'wrong';
                }
                
                // تحويل الحروف الإنجليزية إلى أرقام عربية
                const correctChoicesAr = result.correctChoices.map(c => 
                    c === 'A' ? 'أ' : c === 'B' ? 'ب' : c === 'C' ? 'ج' : c === 'D' ? 'د' : 'هـ'
                ).join('، ');
                
                const studentChoicesAr = result.studentChoices.length > 0 
                    ? result.studentChoices.map(c => 
                        c === 'A' ? 'أ' : c === 'B' ? 'ب' : c === 'C' ? 'ج' : c === 'D' ? 'د' : 'هـ'
                    ).join('، ')
                    : 'لم يتم الاختيار';
                
                detailsHTML += `
                    <div class="question-result ${resultClass}">
                        <div class="question-result-header">
                            <span>السؤال ${questionNum}</span>
                            <span>${result.score.toFixed(2)} نقطة</span>
                        </div>
                        <div class="result-details">
                            <div>الإجابات الصحيحة: <span class="correct-answers">${correctChoicesAr}</span></div>
                            <div>إجاباتك: <span class="student-answers">${studentChoicesAr}</span></div>
                            <div class="note">${result.note}</div>
                        </div>
                    </div>
                `;
            }
            
            resultsDetails.innerHTML = detailsHTML;
        }
        
        // إعادة تعيين الامتحان
        function resetExam() {
            // إلغاء تحديد جميع الخيارات
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // إزالة التحديد المرئي
            const options = document.querySelectorAll('.option');
            options.forEach(option => {
                option.classList.remove("selected");
            });
            
            // إعادة تعيين النتائج
            const scoreBox = document.getElementById('scoreBox');
            scoreBox.innerHTML = `
                <h2>النتيجة</h2>
                <p>سيظهر هنا تقييم إجاباتك بعد التصحيح</p>
                <div class="score">--/5</div>
                <p>نسبة النجاح: --%</p>
            `;
            
            const resultsDetails = document.getElementById('resultsDetails');
            resultsDetails.innerHTML = `
                <h3>تفاصيل التصحيح</h3>
                <p>بعد الضغط على زر "تصحيح الإجابات"، ستظهر هنا تفاصيل كل سؤال ونتيجته.</p>
            `;
            
            // إعادة تعيين إجابات الطالب
            studentAnswers = {};
        }
        
        // تهيئة أولية
        document.addEventListener('DOMContentLoaded', function() {
            // جعل النقر على الخيارات يعمل بشكل صحيح
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function(e) {
                    // منع النقر على checkbox من التأثير مرتين
                    if (e.target.tagName !== 'INPUT') {
                        const checkbox = this.querySelector('input');
                        if (checkbox) {
                            checkbox.checked = !checkbox.checked;
                            this.classList.toggle("selected");
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
